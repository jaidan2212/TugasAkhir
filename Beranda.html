<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TOEFL Test Platform</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    nav { background: #333; color: white; padding: 10px; display: flex; gap: 20px; }
    nav a { color: white; text-decoration: none; }
    .container { padding: 20px; }
    .hidden { display: none; }
    .question { margin-bottom: 10px; }
    .leaderboard, .certificate { margin-top: 20px; }
    .score-preview { margin: 10px 0; font-weight: bold; color: green; }
  </style>
</head>
<body>
  <nav>
    <a href="Dashboard.html" onclick="showPage('dashboard')">Dashboard</a>
    <a href="TA.html" onclick="showPage('test')">Test</a>
    <a href="Beranda.html" onclick="showPage('home')">Beranda</a>
  </nav>
  <div class="container">
    <div id="home">Selamat datang di platform TOEFL!</div><div id="dashboard" class="hidden">
  <h2>Dashboard</h2>
  <div>Nama: <span id="userName">Zaidan</span></div>
  <div>Riwayat Tes:</div>
  <ul id="testHistory"></ul>
  <button onclick="editProfile()">Edit Profil</button>
</div>

<div id="test" class="hidden">
  <h2>TOEFL Test</h2>
  <div>
    <label>
      Mode:
      <select id="mode">
        <option value="ujian">Ujian</option>
        <option value="latihan">Latihan</option>
      </select>
    </label>
  </div>
  <div id="questionBox"></div>
  <button onclick="prevQuestion()">Sebelumnya</button>
  <button onclick="nextQuestion()">Berikutnya</button>
  <div class="score-preview">Skor Sementara: <span id="tempScore">0</span></div>
  <div>Timer: <span id="timer">00:00</span></div>
  <button onclick="submitTest()">Selesai</button>
</div>

<div id="results" class="hidden">
  <h2>Hasil Test</h2>
  <p>Skor Anda: <span id="score">0</span></p>
  <div id="pembahasan"></div>
  <div class="leaderboard">
    <h3>Leaderboard</h3>
    <ul id="leaderboardList"></ul>
  </div>
  <div class="certificate">
    <button onclick="downloadCertificate()">Download Sertifikat PDF</button>
  </div>
</div>

  </div>  <script>
    let currentQuestionIndex = 0;
    let userAnswers = [];
    let score = 0;
    let timer;

    const questions = Array.from({ length: 100 }, (_, i) => ({
      question: Soal ${i + 1},
      options: ['A', 'B', 'C', 'D'],
      correct: 'A'
    }));

    function showPage(id) {
      document.querySelectorAll('.container > div').forEach(div => div.classList.add('hidden'));
      document.getElementById(id).classList.remove('hidden');
    }

    function editProfile() {
      const name = prompt("Masukkan nama baru:", document.getElementById("userName").textContent);
      if (name) document.getElementById("userName").textContent = name;
    }

    function renderQuestion() {
      const q = questions[currentQuestionIndex];
      const qBox = document.getElementById("questionBox");
      qBox.innerHTML = `
        <div class="question">
          <strong>${q.question}</strong><br />
          ${q.options.map((opt, i) => `
            <label><input type="radio" name="answer" value="${opt}" ${userAnswers[currentQuestionIndex] === opt ? 'checked' : ''}/> ${opt}</label><br />
          `).join('')}
        </div>
      `;
      updateTempScore();
    }

    function nextQuestion() {
      saveAnswer();
      if (currentQuestionIndex < questions.length - 1) {
        currentQuestionIndex++;
        renderQuestion();
      }
    }

    function prevQuestion() {
      saveAnswer();
      if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        renderQuestion();
      }
    }

    function saveAnswer() {
      const selected = document.querySelector('input[name="answer"]:checked');
      if (selected) userAnswers[currentQuestionIndex] = selected.value;
      updateTempScore();
    }

    function updateTempScore() {
      const correctCount = userAnswers.reduce((acc, ans, idx) => ans === questions[idx].correct ? acc + 1 : acc, 0);
      const converted = Math.round(correctCount / questions.length * 677);
      document.getElementById("tempScore").textContent = converted;
    }

    function startTimer(duration) {
      let time = duration;
      timer = setInterval(() => {
        const minutes = Math.floor(time / 60);
        const seconds = time % 60;
        document.getElementById("timer").textContent = ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')};
        if (--time < 0) clearInterval(timer);
      }, 1000);
    }

    function calculateScore() {
      score = userAnswers.reduce((acc, answer, i) => answer === questions[i].correct ? acc + 1 : acc, 0);
      return Math.round(score / questions.length * 677);
    }

    function submitTest() {
      clearInterval(timer);
      const finalScore = calculateScore();
      document.getElementById("score").textContent = finalScore;
      document.getElementById("pembahasan").innerHTML = "<p>Setiap jawaban telah dievaluasi. Silakan tinjau kembali untuk pembelajaran.</p>";
      updateLeaderboard(finalScore);
      saveHistory(finalScore);
      showPage("results");
    }

    function saveHistory(score) {
      const history = document.getElementById("testHistory");
      const li = document.createElement("li");
      li.textContent = Skor: ${score};
      history.appendChild(li);
    }

    function updateLeaderboard(score) {
      const lb = document.getElementById("leaderboardList");
      const li = document.createElement("li");
      li.textContent = Zaidan - ${score};
      lb.appendChild(li);
    }

    function downloadCertificate() {
      alert("Sertifikat PDF berhasil dibuat. (Fungsi simulasional)");
    }

    document.getElementById("mode").addEventListener("change", e => {
      const isExam = e.target.value === 'ujian';
      clearInterval(timer);
      startTimer(isExam ? 1800 : 3600);
    });

    renderQuestion();
    startTimer(1800);
  </script></body>
</html>
